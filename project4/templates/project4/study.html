{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
  {# make sure your project4.css includes the study styles we added earlier #}
  <link rel="stylesheet" href="{% static 'project4.css' %}?v=10">
{% endblock %}

{% block content %}
<div class="project4 study page-with-topbar">

  <!-- Top navigation bar -->
  <div class="top-bar">
    <a href="{% url 'home:index' %}" class="home-button">Home</a>
    <a href="{% url 'project4:index' %}" class="proj4-button">Project 4</a>
  </div>

  <h1>Study</h1>

  <!-- Current recommendations -->
  <section class="recommendations card">
    <h2>Your Current Top-5 Recommendations</h2>
    {% if current_recs %}
      <ol class="rec-list">
        {% for title in current_recs %}
          <li>{{ title }}</li>
        {% endfor %}
      </ol>
    {% else %}
      <p>No recommendations yet. Rate a movie below to get started!</p>
    {% endif %}
  </section>

  <!-- Predicted (if you “Loved It”) -->
  <section class="recommendations card">
    <h2>If You Rate “Loved It”</h2>
    {% if predicted_recs %}
      <ol class="rec-list">
        {% for title in predicted_recs %}
          <li>{{ title }}</li>
        {% endfor %}
      </ol>
    {% endif %}
  </section>

  <!-- Rating row -->
  <section class="rating-form card">
    <h2>Rate this Movie</h2>

    <form method="post" class="rate-inline">
      {% csrf_token %}
      <input type="hidden" name="movie_id" value="{{ next_movie_id }}">

      <!-- Movie name / id -->
      <div class="movie-pill">
        <strong>{{ next_movie_title }}</strong>
        <span class="muted">(ID {{ next_movie_id }})</span>
      </div>

      <!-- Rating input (inline with label) -->
      <label for="rating" class="rating-label">Your rating (0.5–5.0):</label>
      <input id="rating" name="rating" type="number" step="0.5" min="0.5" max="5" required class="rating-input">

      <!-- Actions -->
      <div class="btn-group">
        <button type="submit" name="action" value="rate" class="btn btn-primary">
          Submit Rating
        </button>
        <button type="submit" name="action" value="rate_and_analyze" class="btn btn-outline">
          Submit &amp; View Guidance
        </button>
      </div>
    </form>
  </section>

</div>
{% endblock %}
