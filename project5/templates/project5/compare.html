{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'project2.css' %}">
{% endblock %}

{% block content %}
<div class="project2">

  <a href="{% url 'home:index' %}" class="home-button">Home</a>

  <section>
    <h1>Choose the better trajectory</h1>

    {% if message %}
      <p>{{ message }}</p>
      <div class="btn-row" style="margin-top:0.75rem;">
        <a class="home-button" href="{% url 'project5:sample' %}">Sample trajectories</a>
        <a class="home-button" href="{% url 'project5:index' %}">Back to page</a>
      </div>
    {% else %}
      <form method="post" class="form-block">
        {% csrf_token %}
        <input type="hidden" name="idx_a" value="{{ idx_a }}">
        <input type="hidden" name="idx_b" value="{{ idx_b }}">

        <div class="card-grid" style="display:flex;flex-wrap:wrap;gap:16px;justify-content:center;">
          <div class="card" style="min-width:260px;max-width:320px;">
            <div class="card-body">
              <h3>A</h3>
              <div class="metrics" style="margin-top:0.5rem;">
                <div><strong>Length:</strong> {{ A.length }}</div>
                <div><strong>Return:</strong> {{ A.return|floatformat:2 }}</div>
                <div><strong>Cheese steps:</strong> {{ A.cheese }}</div>
                <div><strong>Trap hits:</strong> {{ A.traps }}</div>
              </div>
              <div style="margin-top:0.75rem;">
                <label><input type="radio" name="preference" value="A" {% if not preference or preference == 'A' %}checked{% endif %}> Prefer A</label>
              </div>
            </div>
          </div>

          <div class="card" style="min-width:260px;max-width:320px;">
            <div class="card-body">
              <h3>B</h3>
              <div class="metrics" style="margin-top:0.5rem;">
                <div><strong>Length:</strong> {{ B.length }}</div>
                <div><strong>Return:</strong> {{ B.return|floatformat:2 }}</div>
                <div><strong>Cheese steps:</strong> {{ B.cheese }}</div>
                <div><strong>Trap hits:</strong> {{ B.traps }}</div>
              </div>
              <div style="margin-top:0.75rem;">
                <label><input type="radio" name="preference" value="B" {% if preference == 'B' %}checked{% endif %}> Prefer B</label>
              </div>
            </div>
          </div>
        </div>

        <div style="margin-top:1rem;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
          <button type="submit">Submit preference</button>
          <a class="btn" href="{% url 'project5:compare' %}">Show another pair</a>
        </div>

        <p style="text-align:center;margin-top:0.75rem;">
          <strong>Collected so far:</strong> {{ num_prefs }}
        </p>
      </form>

      <p> Go to back page once you have collected enough preferences </p>
      <div style="margin-top:1rem;">
        <a href="{% url 'project5:index' %}" class="home-button">Back to page</a>
      </div>
    {% endif %}
  </section>

</div>
{% endblock %}
